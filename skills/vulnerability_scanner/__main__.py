#!/usr/bin/env python3
"""CLI entry point for vulnerability scanner."""

import sys
import argparse
from pathlib import Path

from skills.vulnerability_scanner.scanner import VulnerabilityScanner


def main():
    parser = argparse.ArgumentParser(
        description='Vulnerability Scanner - Scan Python code for security issues',
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog="""
Examples:
  python -m skills.vulnerability_scanner                    # Scan current directory
  python -m skills.vulnerability_scanner /path/to/code      # Scan specific directory
  python -m skills.vulnerability_scanner --json             # JSON output
  python -m skills.vulnerability_scanner --json /path       # JSON output for specific path
        """
    )
    
    parser.add_argument(
        'path',
        nargs='?',
        default='.',
        help='Path to scan (default: current directory)'
    )
    parser.add_argument(
        '--json',
        action='store_true',
        help='Output results as JSON'
    )
    parser.add_argument(
        '--severity',
        choices=['critical', 'high', 'medium', 'low', 'info'],
        help='Filter by minimum severity level'
    )
    parser.add_argument(
        '--category',
        choices=['injection', 'secrets', 'crypto', 'path', 'config'],
        help='Filter by category'
    )
    
    args = parser.parse_args()
    
    scanner = VulnerabilityScanner(args.path)
    
    if args.json:
        report = scanner.scan_directory()
        print(report)
    else:
        scanner.print_report()


if __name__ == "__main__":
    main()
